# キーバインド
C：Ctrlを押しながら  
M：Meta（Altを押しながら、またはEscを押した直後）

| key     | action                                             |
|:--------|:---------------------------------------------------|
| C-f     | 1文字前に移動                                      |
| C-b     | 1文字後ろに移動                                    |
| C-a     | 行頭に移動                                         |
| C-e     | 行末に移動                                         |
| M-f     | 1単語前に移動                                      |
| M-b     | 1単語後ろに移動                                    |
| C-h     | 後ろの1文字削除                                    |
| C-d     | 前の1文字削除（文字がない場合はログアウト）        |
| C-w     | 1単語削除                                          |
| C-k     | 行末まで削除                                       |
| C-u     | 行頭まで削除                                       |
| C-y     | 最後に削除した内容を挿入                           |
| C-s     | 画面表示をロック                                   |
| C-q     | 画面表示のロックを解除                             |
| C-c     | 実行中のコマンドを強制終了                         |
| C-l     | 画面を消去                                         |
| C-p     | 前の履歴を表示                                     |
| C-n     | 次の履歴を表示                                     |
| C-r     | 履歴をインクリメンタルサーチ                       |
| C-r     | （履歴サーチ中）一つ前の検索結果へ移動             |
| Enter   | （履歴サーチ中）現在の検索結果を実行               |
| Esc     | （履歴サーチ中）現在の検索結果をプロンプトに表示   |
| C-g     | （履歴サーチ中）検索結果を破棄してプロンプトに戻る |

# ジョブ、プロセスに関するコマンド
| command            | action                                   |
|:-------------------|:-----------------------------------------|
| C-z                | ジョブを一時停止                         |
| jobs -l            | ジョブ一覧（プロセスID付き）を表示       |
| fg %ジョブ番号     | ジョブをフォアグランドにする             |
| bg %ジョブ番号     | ジョブをバッググランドにする             |
| kill %ジョブ番号   | ジョブを終了する                         |
| ps auxww           | プロセス一覧を表示幅を制限せずに全て表示 |
| kill プロセスID    | プロセスを終了する                       |
| kill -9 プロセスID | プロセスを強制終了する                   |
| wait プロセスID    | プロセスが終了するまで待機する           |

## ジョブ、プロセスとは
- プロセスはLinuxカーネルから見た処理単位
- ジョブはシェルごとの処理単位
- $ ls -la | cat -n | less
	- 上の例の場合、ジョブは1つ、プロセスは3つ

# コマンドに関するコマンド
| command        | action                                                     |
|:---------------|:-----------------------------------------------------------|
| which -a       | 一致する全てのコマンドを表示                               |
| type           | エイリアスの確認                                           |
| man -k         | マニュアルをキーワード検索する                             |
| xargs コマンド | 標準入力から受け取った引数リストに対してコマンドを実行する |
| :              | 常に終了ステータス0を返す。while :で無限ループとなる       |

		find . -name '*.csv' | xargs grep ABC

- 下記のようにコマンドが構築され、拡張子がcsvでABCを含む行を表示する

		grep ABC aaa.csv bbb.csv ccc.csv

# 変数
- 外部コマンドからシェル変数を参照することはできない
- 環境変数は、外部コマンドから参照可能

| command  | action                                   |
|:---------|:-----------------------------------------|
| printenv | 環境変数を一覧表示                       |
| export   | 環境変数を設定                           |
| type     | 組み込みコマンドか外部コマンドか判定する |

	変数名=値 コマンド
	(変数名=値; export 変数名; コマンド)

- 2行は同じ意味
- 上の場合、;を入れてはいけない

# ファイル、ディレクトリに関するコマンド
| command | action                                 |
|:--------|:---------------------------------------|
| *       | 任意の文字列を表すワイルドカード       |
| ?       | 任意の1文字を表すワイルドカード        |
| [a-z]   | aからzの任意の一字                     |
| [!a-z]  | aからz以外の任意の一字                 |
| cd -    | 移動元のディレクトリに移動             |
| ls -F   | ファイル名の後に種類を付加             |
| cp -p   | 複数階層のディレクトリを1度に作成      |
| ln -s   | シンボリックリンクを作成               |
| du      | ファイルやディレクトリの使用容量を表示 |
| groups  | 所属するグループを表示                 |

## ワイルドカードの注意点
- 隠しファイル（.〜）は展開されないため、'.*'のように指定する必要がある
	- [.]*でも隠しファイルは展開されない

## リダイレクト
| command          | action                                           |
|:-----------------|:-------------------------------------------------|
| 2> ファイル      | 標準エラー出力をファイルに変更する               |
| > ファイル 2>&1  | 標準出力と標準エラー出力を共にファイルに変更する |
| > /dev/null 2>&1 | 標準出力と標準エラー出力を共に破棄する           |

- リダイレクションはサブシェル上で動作する

## less
### less中の操作

| command    | action              |
|:-----------|:--------------------|
| f or Space | 1画面下にスクロール |
| b          | 1画面上にスクロール |
| j or Enter | 1行下にスクロール   |
| k          | 1行上にスクロール   |
| q          | lessを終了          |
| /          | 下に検索            |
| ?          | 上に検索            |
| n          | 次の検索結果に移動  |
| N          | 前の検索結果に移動  |

## find
### 書式
find <検索開始ディレクトリ> <検索条件> <アクション>

### 検索条件
| command | action                                 |
|:--------|:---------------------------------------|
| -name   | ファイル名で検索（大文字小文字を区別） |
| -iname  | ファイル名で検索（大文字小文字を無視） |
| -type f | 通常ファイルのみ検索                   |
| -type d | ディレクトリのみ検索                   |
| -type l | シンボリックリンクのみ検索             |

### アクション
デフォルトは-printで、標準出力に表示する

### 例
- find -type f -name '*hoge*'
	- 通常ファイルかつファイル名にhogeを含むファイルを検索する
	- ファイル名の検索でワイルドカードを使用する場合は、必ずシングルクォート等で囲む。囲わないとシェルで展開後のファイル名がfindにわたってしまうため。
	- 検索条件を複数指定するとAND検索になる

## locate
### 書式
locate [オプション] <検索パターン>

### DB更新
sudo updatedb

### オプション
| option | action                 |
|:-------|:-----------------------|
| -i     | 大文字小文字を無視     |
| -b     | 通常ファイル名のみ検索 |
| -A     | 複数条件をAND検索      |

### 例
- locate bash doc
	- bashとdocのどちらかを含むファイル/ディレクトリを検索
	- 複数条件を指定した場合、デフォルトはOR検索になる
	- ワイルドカードを使用しない場合は部分一致検索となる
- locate -A '*.txt' xyz
	- .txtで終わり、かつxyzを含むファイル/ディレクトリを検索
	- ワイルドカードを使用する場合は、シングルクォーテーション等で囲む

# テキストに関するコマンド
| command           | action                                          |
|:------------------|:------------------------------------------------|
| cat [ファイル]... | 複数のファイルを連結して表示                    |
| cat -n            | 行番号を表示                                    |
| wc                | 行数、単語数、バイト数を表示する                |
| wc -l             | 行数を表示                                      |
| wc -w             | 単語数を表示                                    |
| wc -c             | バイト数を表示                                  |
| sort -k5          | 5番目のフィールドを対象にして辞書順に並び替える |
| sort -n           | 数値順に並び替える                              |
| sort -r           | 降順で並び替える                                |
| sort -u           | 重複行を1行だけ表示する                         |
| uniq -c           | 重複行の行数を表示する                          |
| cut -d, -f1,5     | ,で区切り1番目と5番目のフィールドを切り出す     |
| tr abc ABC        | aをA、bをB、cをCに置き換える                    |
| tr a-c A-C        | aをA、bをB、cをCに置き換える                    |
| tr -d "\n"        | LFを削除する                                    |
| tail -f           | ファイルへの追記を監視する                      |
| grep -n           | 行番号付きで表示                                |
| grep -i           | 大文字小文字を無視                              |
| grep -v           | マッチしなかった行を表示                        |
| grep -E           | 拡張正規表現を使用する                          |

## 正規表現を使う際の注意点
- シングルクォーテーション等で囲うこと。*等をシェルが展開しないようにするため

## sed
### 書式
sed [オプション] <アドレス><コマンド>

### オプション
| option | action                       |
|:-------|:-----------------------------|
| -n     | パターンスペースを表示しない |
| -r     | 拡張正規表現を使用する       |
| -e     | コマンドを複数実行する       |

#### 例
- sed -e 's/aaa/bbb/g' -e 's/ccc/ddd/g'

### アドレス
| address               | action                   |
|:----------------------|:-------------------------|
| 1                     | 1行目                    |
| 2,5                   | 2行目から5行目           |
| 3,$                   | 3行目から最終行          |
| （省略）              | 全行                     |
| /正規表現/            | 正規表現に一致する行     |
| /正規表現/,/正規表現/ | 正規表現に一致する間の行 |

### コマンド
| command | action         |
|:--------|:---------------|
| d       | 行を削除       |
| p       | 行を表示       |
| s       | 行を置換       |
| !p      | 行を表示しない |

- !を付けると逆の処理を行う

### 置換
#### 書式
s/置換前文字列/置換後文字列/フラグ

#### フラグ
| flag | action                                 |
|:-----|:---------------------------------------|
| g    | 一致した全ての文字列を置換             |
| p    | 置換を実行した場合に、置換後の行を表示 |

#### 後方参照
- sed 's/aaa(.*)/bbb\1/g'
	- aaaに続く文字列をbbbの後に付加する
	- 基本正規表現の場合は\(、\)のように\を付ける

#### アドレス指定
- sed '1,3s/aaa/bbb/g'
	- 1行目から3行目のaaaをbbbに置換する

### パターンスペース
- sedでは、1行読み込んでパターンスペースにコピーした後、コマンドの実行とパターンスペースの表示を行う
- sed 1p
	- 1行目を表示後にパターンスペースを表示
	- 1行目を2行表示した後に、2行目以降を表示することになる
- sed s/aaa/AAA/g
	- 置換を実行後にパターンスペースを表示
	- 置換した場合は置換後の文字列、置換しなかった場合は置換前の文字列を表示することになる
- sed -n 1p
	- 1行目だけを表示
- sed -n s/aaa/AAA/gp
	- 置換が発生した行だけを表示

## awk
### 書式
awk [オプション] パターン {アクション}
- パターンにアクションを実行する条件を記述する
- パターンを省略した場合は全レコードに対してアクションを実行する

### オプション
| option | action                              |
|:-------|:------------------------------------|
| -F     | 区切り文字を指定する                |
| -f     | awkのコマンドをファイルから読み込む |

### パターン
- awk '$9 ~ /正規表現/ {print $5,$9}'
	- 9番目のフィールドが正規表現に一致する場合に、5行目と9行目を表示する
- awk '/正規表現/ {print $5,$9}'
	- レコードが正規表現に一致する場合に、5行目と9行目を表示する

### アクション
- アクションを省略するとレコード全体を表示する

#### フィールド変数
- awk '{print $5,$9}'
	- 5列目と9列目のフィールドを表示。フィールドの間にスペースを入れる
- awk '{print $5 $9}'
	- 5列目と9列目のフィールドを表示。フィールドの間にスペースを入れない
- $0にはレコード全体が代入される
- awk '{print $NF,$(NF-1)}'
	- 最後のフィールドと最後から2番めのフィールドを表示する

### 例
- awk -F, '{sum += $NF} END{print sum/NR}'
	- 最後のフィールドの平均値を表示する
	- ENDブロック内のアクションは、全てのレコードを処理した後に実行される
	- NRにはこれまで読み込んだレコード数が代入されている
